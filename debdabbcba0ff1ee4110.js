function _createForOfIteratorHelper(e,a){var o;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(o=_unsupportedIterableToArray(e))||a&&e&&"number"==typeof e.length){o&&(e=o);var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,c=!0,l=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return c=e.done,e},e:function(e){l=!0,r=e},f:function(){try{c||null==o.return||o.return()}finally{if(l)throw r}}}}function _unsupportedIterableToArray(e,a){if(e){if("string"==typeof e)return _arrayLikeToArray(e,a);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(e,a):void 0}}function _arrayLikeToArray(e,a){(null==a||a>e.length)&&(a=e.length);for(var o=0,t=new Array(a);o<a;o++)t[o]=e[o];return t}var id_contato="";function criar_contato_paths(){var e=$("#select_enterprise").val();switch($("#fill_warning").addClass("d-none"),$("#search_warning").addClass("d-none"),$("#search_warning_2").addClass("d-none"),e){case"1":create_contato_pf();break;case"2":create_contato_empresa();break;case"3":create_contato_create_empresa()}}function busca_interacao(e){$.ajax({url:"https://dev.liveuniversity.com:2700/busca_interacao_email",method:"post",data:{email:e}}).then((function(a){interacao=a,id_contato=a[0].id_contato;var o,t,n,r,c=a[0].contato_visibility;c=null==a[0].contato_visibility?"vazio":a[0].contato_visibility,r=0==a[0].voltou?"No-Bounce (0)":"Bounce (1)",o=null==a[0].Cargo?"":a[0].Cargo,t=null==a[0].telefone?"":a[0].telefone,n=null==a[0].area?"":a[0].area,$("#nome").val(a[0].Nome),$("#sobrenome").val(a[0].Sobrenome),$("#email").val(e),$("#id_contato").text(a[0].id_contato),$("#interacao").val(a[0].IDInteracao),$("#projeto").val(a[0].IDProjeto),$("#observacao").text(a[0].observacao),$("#status").val(a[0].status_processo),$("#operador").val(a[0].operador),$("#origem").val(a[0].origem_interacao),$("#telefone").val(t),$("#area").val(n),$("#cargo").val(o),$("#current_visibility").text(c),$("#current_bounce").text(r);var l,i="",s=_createForOfIteratorHelper(a[0].email_array);try{for(s.s();!(l=s.n()).done;)mail=l.value,i+='\n            <div class="input-group input-group-sm mb-2 email_input_div">\n              <input value=\''.concat(mail.email,"' id=\"email-").concat(mail.id_email,'" type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" readonly>\n              <img onclick="change_btn_function_user(this)" id="edit_email_btn" class="hover-pointer" src="4fa02ba3eeb22ca444b3.svg" alt="">\n              <img onclick="change_btn_function_user(this), update_contato_info(\'email\', ').concat(mail.id_email,')" id="update_email_btn" class="d-none hover-pointer check" src="222a1c7ef846e3979556.svg" alt="">\n              <img onclick="delete_parent(this, \'email\', ').concat(mail.id_email,')" id="edit_email_btn" class="d-none hover-pointer trash" src="1129c53a10f3c7163570.svg" alt="">\n            </div>\n          ')}catch(e){s.e(e)}finally{s.f()}$("#email_span").after(i);var _,d="",m=_createForOfIteratorHelper(a[0].telefone_array);try{for(m.s();!(_=m.n()).done;)phone=_.value,d+='\n            <div class="input-group input-group-sm mb-2 telefone_input_div">\n              <input value=\'('.concat(phone.DDD.toString(),") ").concat(phone.Prefixo.toString(),"-").concat(phone.Sufixo,'\' onkeypress="mask(this, mphone);" onblur="mask(this, mphone);" id="telefone-').concat(phone.id_contato_telefone,'" type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" readonly>\n              <img onclick="change_btn_function_user(this)" id="edit_telefone_btn" class="hover-pointer" src="4fa02ba3eeb22ca444b3.svg" alt="">\n              <img onclick="change_btn_function_user(this), update_contato_info(\'telefone\', ').concat(phone.id_contato_telefone,')" id="update_telefone_btn" class="d-none hover-pointer check" src="222a1c7ef846e3979556.svg" alt="">\n              <img onclick="delete_parent(this, \'telefone\', ').concat(phone.id_contato_telefone,')" id="edit_telefone_btn" class="d-none hover-pointer trash" src="1129c53a10f3c7163570.svg" alt="">\n            </div>\n          ')}catch(e){m.e(e)}finally{m.f()}$("#telefone_span").after(d),loadOff()})).fail((function(e){loadOff(),$("#search_modal").modal("show")}))}function create_contato_pf(){var e=$("#create_contato_nome").val(),a=$("#create_contato_sobrenome").val(),o=$("#create_contato_email").val(),t=$("#create_contato_sexo").val();if(e&&a&&o&&t){$("#fill_warning").addClass("d-none");var n={nome:e,sobrenome:a,email:o,sexo:t};$("#close_modal_search_btn").click(),loadOn(),modal_reset(),$.ajax({url:"https://dev.liveuniversity.com:2700/criar_contato",method:"post",data:n}).then((function(e){loadOff(),$("#resposta_criacao_contato").text("ID Contato: ".concat(e[0].id_contato)),$("#user_criado_modal").modal("show"),busca_interacao(e[0].email)})).fail((function(e){loadOff(),$("#create_contato_nome").val(""),$("#create_contato_sobrenome").val(""),$("#create_contato_email").val(""),$("#create_contato_sexo").val(""),$("#erro_criacao_modal").modal("show")}))}else $("#fill_warning").removeClass("d-none")}function create_contato_empresa(){var e=$("#create_contato_nome").val(),a=$("#create_contato_sobrenome").val(),o=$("#create_contato_email").val(),t=$("#create_contato_sexo").val(),n=$("#selected_empresa_input").attr("id_empresa");if(e&&a&&o&&t)if($("#fill_warning").addClass("d-none"),n){$("#search_warning_2").addClass("d-none");var r={nome:e,sobrenome:a,email:o,sexo:t,empresa:n};$("#close_modal_search_btn").click(),loadOn(),modal_reset(),console.log(r),$.ajax({url:"https://dev.liveuniversity.com:2700/criar_contato_empresa",method:"post",data:r}).then((function(e){loadOff(),$("#resposta_criacao_contato").text("ID Contato: ".concat(e[0].id_contato)),$("#user_criado_modal").modal("show"),busca_interacao(e[0].email)})).fail((function(e){loadOff(),$("#create_contato_nome").val(""),$("#create_contato_sobrenome").val(""),$("#create_contato_email").val(""),$("#create_contato_sexo").val(""),$("#erro_criacao_modal").modal("show")}))}else $("#search_warning_2").removeClass("d-none");else $("#fill_warning").removeClass("d-none")}function create_contato_create_empresa(){var e=$("#create_contato_nome").val(),a=$("#create_contato_sobrenome").val(),o=$("#create_contato_email").val(),t=$("#create_contato_sexo").val(),n=$("#criar_empresa_nome").val(),r=$("#criar_empresa_cnpj").val();if(e&&a&&o&&t&&n&&r){$("#fill_warning").addClass("d-none");var c={nome:e,sobrenome:a,sexo:t,email:o,empresa:n,cnpj:r};console.log(c),$("#close_modal_search_btn").click(),loadOn(),modal_reset(),$.ajax({url:"https://dev.liveuniversity.com:2700/create_contato_create_empresa_panda",method:"post",data:c}).then((function(e){console.log(e),loadOff(),$("#resposta_criacao_contato").text("ID Contato: ".concat(e[0].id_contato)),$("#user_criado_modal").modal("show"),busca_interacao(e[0].email)})).fail((function(e){loadOff(),$("#create_contato_nome").val(""),$("#create_contato_sobrenome").val(""),$("#create_contato_email").val(""),$("#create_contato_sexo").val(""),$("#erro_criacao_modal").modal("show")}))}else $("#fill_warning").removeClass("d-none")}function search_email(){var e=$("#search_email_input").val();e&&(loadOn(),busca_interacao(e),$("#close_modal_search_btn").click(),modal_reset())}function show_visbility(e,a){document.getElementById("current_visibility").innerHTML=e.innerHTML;var o={id_contato,id_visibility:a};null!=o.id_contato&&null!=o.id_visibility&&(console.log(o),$.ajax({url:"https://dev.liveuniversity.com:2700/alterar_visibilidade_panda",method:"post",data:o}).then((function(e){console.log(e)})).fail((function(e){console.log(e)})))}function open_pedidos(){loadOn(),$(".nav_items").each((function(e){$(this).removeClass("d-flex"),$(this).addClass("d-none")})),$("#historico_div").removeClass("d-none");var e={id_contato};$.ajax({url:"https://dev.liveuniversity.com:2700/get_historico_pedidos_panda",method:"post",data:e}).then((function(e){$("#pedidos_table_head").empty();var a,o="",t=_createForOfIteratorHelper(e);try{for(t.s();!(a=t.n()).done;)item=a.value,o+='\n        <tr>\n          <th scope="row">'.concat(item.id_pedido,"</th>\n          <td>").concat(item.pedido_status,"</td>\n          <td>").concat(item.pedido_data,"</td>\n        </tr>\n      ")}catch(e){t.e(e)}finally{t.f()}var n='\n      <tr>\n        <th scope="col">Order ID</th>\n        <th scope="col">Order Status</th>\n        <th scope="col">Order Date</th>\n      </tr>\n      '+o+"\n    ";$("#pedidos_table_head").append(n),loadOff()})).fail((function(e){console.log(e),loadOff()}))}function show_bounce(e,a){document.getElementById("current_bounce").innerHTML=e.innerHTML;var o={id_contato,email:senderEmail,bounce_status:a};console.log(o),null!=o.id_contato&&null!=o.bounce_status&&$.ajax({url:"https://dev.liveuniversity.com:2700/alterar_bounce_email",method:"post",data:o}).then((function(e){console.log(e)})).fail((function(e){console.log(e)}))}function select_enterprise(){$("#fill_warning").addClass("d-none");var e=$("#select_enterprise").val();switch(console.log(e),e){case"1":$(".enterprise_class").each((function(e){$(this).addClass("d-none")}));break;case"2":$(".enterprise_class").each((function(e){$(this).addClass("d-none")})),$("#procurar_empresa_div").removeClass("d-none");break;case"3":$(".enterprise_class").each((function(e){$(this).addClass("d-none")})),$("#criar_empresa_div").removeClass("d-none")}}function procura_empresa_path(){if($("#fill_warning").addClass("d-none"),$("#search_warning").addClass("d-none"),$("#search_warning_2").addClass("d-none"),$("#procura_empresa_val").val()){$("#search_warning").addClass("d-none");var e=$("#procura_empresa_tipo").val(),a=$("#procura_empresa_val").val();1==e?search_nome_empresa(a):search_cnpj_empresa(a)}else $("#search_warning").removeClass("d-none")}function search_nome_empresa(e){$("#nothing_found_div").addClass("d-none"),$("#search_load").removeClass("d-none"),$("#empresa_search_tb").empty();var a={empresa:e};$.ajax({url:"https://dev.liveuniversity.com:2700/procura_nome_empresa_panda",method:"post",data:a}).then((function(e){$("#search_load").addClass("d-none"),e.length>0?($("#empresa_search_tb_div").removeClass("d-none"),$("#nothing_found_div").addClass("d-none")):$("#nothing_found_div").removeClass("d-none");var a,o="",t=_createForOfIteratorHelper(e);try{for(t.s();!(a=t.n()).done;)item=a.value,o+="\n        <tr>\n          <td onclick=\"select_this_empresa('".concat(item.empresa,"', '").concat(item.cnpj,"' ,'").concat(item.id_empresa,'\')" style="cursor: pointer">').concat(item.empresa,"</td>\n          <td onclick=\"select_this_empresa('").concat(item.empresa,"', '").concat(item.cnpj,"' ,'").concat(item.id_empresa,'\')" style="cursor: pointer">').concat(item.cnpj,"</td>\n        </tr>\n      ")}catch(e){t.e(e)}finally{t.f()}var n='\n      <tr>\n        <th scope="col">Enterprise</th>\n        <th scope="col">CNPJ</th>\n      </tr>\n      '+o+"\n    ";$("#empresa_search_tb").append(n)})).fail((function(e){$("#search_load").addClass("d-none"),console.log(e)}))}function search_cnpj_empresa(e){$("#nothing_found_div").addClass("d-none"),$("#search_load").removeClass("d-none"),$("#empresa_search_tb").empty();var a={cnpj:e};$.ajax({url:"https://dev.liveuniversity.com:2700/procura_cnpj_empresa_panda",method:"post",data:a}).then((function(e){$("#search_load").addClass("d-none"),e.length>0?$("#empresa_search_tb_div").removeClass("d-none"):$("#nothing_found_div").removeClass("d-none");var a,o="",t=_createForOfIteratorHelper(e);try{for(t.s();!(a=t.n()).done;)item=a.value,o+="\n        <tr>\n          <td onclick=\"select_this_empresa('".concat(item.empresa,"', '").concat(item.cnpj,"' ,'").concat(item.id_empresa,'\')" style="cursor: pointer">').concat(item.empresa,"</td>\n          <td onclick=\"select_this_empresa('").concat(item.empresa,"', '").concat(item.cnpj,"' ,'").concat(item.id_empresa,'\')" style="cursor: pointer">').concat(item.cnpj,"</td>\n        </tr>\n      ")}catch(e){t.e(e)}finally{t.f()}var n='\n      <tr>\n        <th scope="col">Enterprise</th>\n        <th scope="col">CNPJ</th>\n      </tr>\n      '+o+"\n    ";$("#empresa_search_tb").append(n)})).fail((function(e){$("#search_load").addClass("d-none"),console.log(e)}))}function select_this_empresa(e,a,o){console.log(e,a),$("#selected_enterprise_div").removeClass("d-none"),$("#selected_empresa_input").val("".concat(e," - ").concat(a)),$("#selected_empresa_input").attr("id_empresa",o)}function update_contato_info(e,a){var o=$("#".concat(e)).val();a||(a=0),"email"==e&&(o=$("#email-".concat(a)).val());var t={value:o,tipo:e,id_contato,id_val:a};if("telefone"==e){var n=(o=$("#telefone-".concat(a)).val()).split(" ")[0],r=o.split(" ")[1];t={ddd:n=n.replace(/[()]/g,""),prefixo:r.split("-")[0],sufixo:r.split("-")[1],tipo:e,id_contato,id_val:a}}console.log(t),$.ajax({url:"https://dev.liveuniversity.com:2700/update_info_contato_panda",method:"post",data:t}).then((function(e){console.log(e)})).fail((function(e){console.log(e)}))}function delete_parent(e,a,o){$(e).parent().remove();var t={id_contato,tipo:a,value:o};console.log(t),$.ajax({url:"https://dev.liveuniversity.com:2700/delete_info_contato_panda",method:"post",data:t}).then((function(e){console.log(e)})).fail((function(e){console.log(e)}))}Office.onReady((function(e){loadOn(),item=Office.context.mailbox.item,senderEmail=item.sender.emailAddress,senderName=item.sender.displayName,busca_interacao(senderEmail)})),$("#procura_empresa_val").keydown((function(e){13==(e.keyCode?e.keyCode:e.which)&&procura_empresa_path()}));