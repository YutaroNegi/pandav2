{"version":3,"file":"newAndConfig.js","mappings":"MAAA,IACIA,EACAC,EAIJC,OAAOC,SAAQ,SAACC,GACZC,EAAKC,KACLN,EAAOE,OAAOK,QAAQC,QAAQR,KAC9BC,EAAcD,EAAKS,OAAOC,aACbV,EAAKS,OAAOE,YACzBC,QAAUZ,EAAKa,GAAG,GAAGH,aA8FrBI,EAAEC,KAAK,CACHC,IAAK,uCACLC,OAAQ,OACRC,KAAM,CAACjB,YAAAA,KACRkB,MAAK,SAACC,GACLC,QAAQC,IAAIF,GACZ,IAAIG,EAAY,GAChBH,EAAII,SAAQ,SAACxB,GACTuB,GAAa,4CAAJ,OACoBvB,EAAKyB,WADzB,aACwCzB,EAAK0B,aAD7C,aAC8D1B,EAAK2B,uBADnE,YAC6F3B,EAAK4B,sBADlG,aAC4H5B,EAAK6B,QADjI,cAC8I7B,EAAK8B,MADnJ,+CAC8L9B,EAAK+B,YADnM,yBAIbjB,EAAE,cAAckB,QAChBlB,EAAE,cAAcmB,OAAOV,GACvBlB,EAAK6B,SACNC,MAAK,SAACC,GACLf,QAAQC,IAAIc,GACZ/B,EAAK6B,YA4Db,IAAM7B,EAAO,CACTC,GAAI,WACAQ,EAAE,eAAeuB,MAAM,SAE3BH,IAAK,WACDpB,EAAE,eAAeuB,MAAM,W","sources":["webpack:///./src/newAndConfig/newAndConfig.js?"],"sourcesContent":["let yutaro = 'newAndConfig.js'\r\nlet item\r\nlet senderEmail\r\nlet senderName\r\nlet perfil_participante = 1\r\n\r\nOffice.onReady((info) => {\r\n    load.on()\r\n    item = Office.context.mailbox.item;\r\n    senderEmail = item.sender.emailAddress\r\n    senderName = item.sender.displayName\r\n    toEmail = item.to[0].emailAddress\r\n    get_layout()\r\n})\r\n\r\nfunction change_perfil_dropdown(item) {\r\n    console.log(item);\r\n    $('#perfil_dropdown').text($(item).text())\r\n    $('#perfil_dropdown').attr('value', $(item).attr('value'))\r\n    perfil_participante = $(item).attr('value')\r\n}\r\n\r\nfunction send_intercao(){\r\n    let data = {\r\n        sender_email: senderEmail,\r\n        to_email: toEmail,\r\n        id_projeto: Number($('#id_projeto').val()),\r\n        nome_projeto: $('#nome_projeto').val(),\r\n        status: Number($('#status_radio input:radio:checked').val()),\r\n        id_perfil_participante: Number(perfil_participante),\r\n        email_subject: $('#subject_input').val(),\r\n        email_body: tinyMCE.activeEditor.getContent(),\r\n        file: $('#inputGroupFile01').val(),\r\n        id_contato_visibility: $('#status_radio input:radio:checked').attr('visibility')\r\n    }\r\n\r\n    if(!data.id_projeto){\r\n        $('#id_projeto').css('border', '1px solid red')\r\n        return\r\n    }else{\r\n        $('#id_projeto').css('border', '1px solid black')\r\n    }\r\n\r\n    if(!data.nome_projeto){\r\n        $('#nome_projeto').css('border', '1px solid red')\r\n        return\r\n    }else{\r\n        $('#nome_projeto').css('border', '1px solid black')\r\n    }\r\n\r\n    load.on()\r\n    $.ajax({\r\n        url: 'https://dev.liveuniversity.com:2700/send_interacao_decline_opt_out',\r\n        method: 'post',\r\n        data: data\r\n    }).then((res) => {\r\n        load.off()\r\n        if(res[0].res == 1){\r\n            $('#sucess_modal').modal('show')   \r\n            $('.clear').val('')\r\n            tinyMCE.activeEditor.setContent('');\r\n            perfil_participante = 1\r\n            $('#perfil_dropdown').html('Aluno / Congressista')\r\n\r\n            if(data.email_body){\r\n                envia_email(data.email_subject, data.email_body, data.to_email)\r\n            }\r\n        }else{\r\n            $('#error_modal').modal('show')   \r\n        }\r\n        \r\n    }).fail((err)=>{\r\n        load.off()\r\n        console.log(err);\r\n        $('#error_modal').modal('show')   \r\n    })\r\n}\r\n\r\nfunction save_layout(){\r\n    load.on()\r\n    let data = {\r\n        id_projeto: Number($('#id_projeto').val()),\r\n        nome_projeto: $('#nome_projeto').val(),\r\n        status: Number($('#status_radio input:radio:checked').val()),\r\n        id_perfil_participante: Number(perfil_participante),\r\n        email_subject: $('#subject_input').val(),\r\n        email_body: tinyMCE.activeEditor.getContent(),\r\n        id_contato_visibility: $('#status_radio input:radio:checked').attr('visibility'),\r\n        sender_email: senderEmail\r\n    }\r\n\r\n    $.ajax({\r\n        url: 'https://dev.liveuniversity.com:2700/save_layout_panda',\r\n        method: 'post',\r\n        data: data\r\n    }).then((res) => {\r\n        $('#sucess_modal').modal('show')   \r\n        get_layout()\r\n    }).fail((err)=>{\r\n        $('#generic_error_modal').modal('show')   \r\n        load.off()\r\n    })\r\n}\r\n\r\nfunction get_layout(){\r\n    $.ajax({\r\n        url: 'https://dev.liveuniversity.com:2700/get_layout_panda',\r\n        method: 'post',\r\n        data: {senderEmail}\r\n    }).then((res) => {\r\n        console.log(res);\r\n        let drop_item = ''\r\n        res.forEach((item)=>{\r\n            drop_item += `\r\n                <a onclick=\"set_layout(${item.id_projeto},'${item.nome_projeto}',${item.id_perfil_participante},${item.id_contato_visibility},'${item.assunto}','${item.corpo}')\" value=\"\" class=\"dropdown-item\">${item.nome_layout}</a>\r\n            `\r\n        })\r\n        $('#templates').empty()\r\n        $('#templates').append(drop_item)\r\n        load.off()\r\n    }).fail((err)=>{\r\n        console.log(err); \r\n        load.off()\r\n    })\r\n}\r\n\r\nfunction set_layout(id_projeto, nome_projeto, perfil, visibility, assunto, corpo){\r\n    $('#id_projeto').val(id_projeto)\r\n    $('#nome_projeto').val(nome_projeto)\r\n    \r\n    $('.perfil_item').each(function(){\r\n        console.log($(this).attr('value'));\r\n        if($(this).attr('value') == perfil){           \r\n            $('#perfil_dropdown').text($(this).text())\r\n            $('#perfil_dropdown').attr('value', perfil)\r\n            perfil_participante = perfil\r\n        }\r\n    })\r\n\r\n    $('.form-check-input').each(function(i){\r\n        if($(this).attr('visibility') == visibility){\r\n            $(this).prop('checked', true)\r\n        }else{\r\n            $(this).prop('checked', false)\r\n        }\r\n    })\r\n\r\n    $('#subject_input').val(assunto)\r\n    tinyMCE.activeEditor.setContent(corpo);\r\n}\r\n\r\n\r\nfunction envia_email(subject, body, to){\r\n        body = htmlEncode(body)\r\n        var request = '<soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:m=\"http://schemas.microsoft.com/exchange/services/2006/messages\" xmlns:t=\"http://schemas.microsoft.com/exchange/services/2006/types\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">'+\r\n        '  <soap:Header><t:RequestServerVersion Version=\"Exchange2010\" /></soap:Header>'+\r\n        '  <soap:Body>'+\r\n        '    <m:CreateItem MessageDisposition=\"SendAndSaveCopy\">'+\r\n        '      <m:SavedItemFolderId><t:DistinguishedFolderId Id=\"sentitems\" /></m:SavedItemFolderId>'+\r\n        '      <m:Items>'+\r\n        '        <t:Message>'+\r\n        '          <t:Subject>' + subject +'</t:Subject>'+\r\n        '          <t:Body BodyType=\"HTML\">'+ body +'</t:Body>'+\r\n        '          <t:ToRecipients>'+\r\n        '            <t:Mailbox><t:EmailAddress>' + to + '</t:EmailAddress></t:Mailbox>'+\r\n        '          </t:ToRecipients>'+\r\n        '        </t:Message>'+\r\n        '      </m:Items>'+\r\n        '    </m:CreateItem>'+\r\n        '  </soap:Body>'+\r\n        '</soap:Envelope>';\r\n\r\n        Office.context.mailbox.makeEwsRequestAsync(request, function (asyncResult) {\r\n        if (asyncResult.status == \"failed\") {\r\n            showMessage(\"Action failed with error: \" + asyncResult.error.message);\r\n        }\r\n        else {\r\n            showMessage(\"Message sent!\");\r\n        }\r\n        });\r\n}\r\n\r\nconst load = {\r\n    on: function(){\r\n        $('#load_modal').modal('show')    \r\n    },\r\n    off: function(){\r\n        $('#load_modal').modal('hide')    \r\n    }\r\n}\r\n\r\nfunction htmlEncode(value){\r\n    // Create a in-memory element, set its inner text (which is automatically encoded)\r\n    // Then grab the encoded contents back out. The element never exists on the DOM.\r\n    return $('<textarea/>').text(value).html();\r\n  }\r\n  \r\nfunction htmlDecode(value){\r\n    return $('<textarea/>').html(value).text();\r\n}"],"names":["item","senderEmail","Office","onReady","info","load","on","context","mailbox","sender","emailAddress","displayName","toEmail","to","$","ajax","url","method","data","then","res","console","log","drop_item","forEach","id_projeto","nome_projeto","id_perfil_participante","id_contato_visibility","assunto","corpo","nome_layout","empty","append","off","fail","err","modal"],"sourceRoot":""}