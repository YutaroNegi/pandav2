{"version":3,"file":"newAndConfig.js","mappings":"MAAA,IACIA,EAKJC,OAAOC,SAAQ,SAACC,IACZH,EAAOC,OAAOG,QAAQC,QAAQL,MACXM,OAAOC,aACbP,EAAKM,OAAOE,YACzBC,QAAUT,EAAKU,GAAG,GAAGH,iB","sources":["webpack:///./src/newAndConfig/newAndConfig.js?"],"sourcesContent":["let yutaro = 'newAndConfig.js'\r\nlet item\r\nlet senderEmail\r\nlet senderName\r\nlet perfil_participante = 1\r\n\r\nOffice.onReady((info) => {\r\n    item = Office.context.mailbox.item;\r\n    senderEmail = item.sender.emailAddress\r\n    senderName = item.sender.displayName\r\n    toEmail = item.to[0].emailAddress\r\n})\r\n\r\nfunction change_perfil_dropdown(item) {\r\n    $('#perfil_dropdown').html($(item).text())\r\n    perfil_participante = $(item).attr('value')\r\n}\r\n\r\nfunction send_intercao(){\r\n    let data = {\r\n        sender_email: senderEmail,\r\n        to_email: toEmail,\r\n        id_projeto: Number($('#id_projeto').val()),\r\n        nome_projeto: $('#nome_projeto').val(),\r\n        status: Number($('#status_radio input:radio:checked').val()),\r\n        id_perfil_participante: Number(perfil_participante),\r\n        email_body: tinyMCE.activeEditor.getContent({format : 'raw'}),\r\n        file: $('#inputGroupFile01').val()    \r\n\r\n    }\r\n\r\n    if(!data.id_projeto){\r\n        $('#id_projeto').css('border', '1px solid red')\r\n        return\r\n    }else{\r\n        $('#id_projeto').css('border', '1px solid black')\r\n    }\r\n\r\n    if(!data.nome_projeto){\r\n        $('#nome_projeto').css('border', '1px solid red')\r\n        return\r\n    }else{\r\n        $('#nome_projeto').css('border', '1px solid black')\r\n    }\r\n\r\n    if(!data.email_body){\r\n        $('#form_div').css('border', '1px solid red')\r\n        return\r\n    }else{\r\n        $('#form_div').css('border', '1px solid black')\r\n    }\r\n\r\n    load.on()\r\n    $.ajax({\r\n        url: 'http://localhost:80/send_interacao_decline_opt_out',\r\n        method: 'post',\r\n        data: data\r\n    }).then((res) => {\r\n        load.off()\r\n        if(res[0].res == 1){\r\n            $('#sucess_modal').modal('show')   \r\n            $('.clear').val('')\r\n            tinyMCE.activeEditor.setContent('');\r\n            perfil_participante = 1\r\n            $('#perfil_dropdown').html('Aluno / Congressista')\r\n            envia_email(data.email_body, data.to_email)\r\n        }else{\r\n            $('#error_modal').modal('show')   \r\n        }\r\n        \r\n    }).fail((err)=>{\r\n        load.off()\r\n        console.log(err);\r\n        $('#error_modal').modal('show')   \r\n    })\r\n}\r\n\r\n\r\nfunction envia_email(body, to){\r\n        body = htmlEncode(body)\r\n        var request = '<soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:m=\"http://schemas.microsoft.com/exchange/services/2006/messages\" xmlns:t=\"http://schemas.microsoft.com/exchange/services/2006/types\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">'+\r\n        '  <soap:Header><t:RequestServerVersion Version=\"Exchange2010\" /></soap:Header>'+\r\n        '  <soap:Body>'+\r\n        '    <m:CreateItem MessageDisposition=\"SendAndSaveCopy\">'+\r\n        '      <m:SavedItemFolderId><t:DistinguishedFolderId Id=\"sentitems\" /></m:SavedItemFolderId>'+\r\n        '      <m:Items>'+\r\n        '        <t:Message>'+\r\n        '          <t:Subject>Hello, Outlook!</t:Subject>'+\r\n        '          <t:Body BodyType=\"HTML\">'+ body +'</t:Body>'+\r\n        '          <t:ToRecipients>'+\r\n        '            <t:Mailbox><t:EmailAddress>' + to + '</t:EmailAddress></t:Mailbox>'+\r\n        '          </t:ToRecipients>'+\r\n        '        </t:Message>'+\r\n        '      </m:Items>'+\r\n        '    </m:CreateItem>'+\r\n        '  </soap:Body>'+\r\n        '</soap:Envelope>';\r\n\r\n        Office.context.mailbox.makeEwsRequestAsync(request, function (asyncResult) {\r\n        if (asyncResult.status == \"failed\") {\r\n            showMessage(\"Action failed with error: \" + asyncResult.error.message);\r\n        }\r\n        else {\r\n            showMessage(\"Message sent!\");\r\n        }\r\n        });\r\n}\r\n\r\nconst load = {\r\n    on: function(){\r\n        $('#load_modal').modal('show')    \r\n    },\r\n    off: function(){\r\n        $('#load_modal').modal('hide')    \r\n    }\r\n}\r\n\r\nfunction htmlEncode(value){\r\n    // Create a in-memory element, set its inner text (which is automatically encoded)\r\n    // Then grab the encoded contents back out. The element never exists on the DOM.\r\n    return $('<textarea/>').text(value).html();\r\n  }\r\n  \r\nfunction htmlDecode(value){\r\n    return $('<textarea/>').html(value).text();\r\n}"],"names":["item","Office","onReady","info","context","mailbox","sender","emailAddress","displayName","toEmail","to"],"sourceRoot":""}