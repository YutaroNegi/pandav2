{"version":3,"file":"newAndConfig.js","mappings":"MAAA,IACIA,EACAC,EAIAC,EAsJJ,SAASC,IACLC,EAAEC,KAAK,CACHC,IAAK,uCACLC,OAAQ,OACRC,KAAM,CAACP,YAAaC,EAASD,EAAcQ,WAC5CC,MAAK,SAACC,GACL,GAAiB,GAAdA,EAAIC,OAAP,CAIAC,QAAQC,IAAIH,GACZ,IAAII,EAAY,GAChBJ,EAAIK,SAAQ,SAAChB,GACTe,GAAa,4CAAJ,OACoBf,EAAKiB,WADzB,aACwCjB,EAAKkB,aAD7C,aAC8DlB,EAAKmB,uBADnE,YAC6FnB,EAAKoB,sBADlG,aAC4HpB,EAAKqB,QADjI,cAC8IrB,EAAKsB,MADnJ,cAC8JtB,EAAKuB,aADnK,6CACoNvB,EAAKwB,YADzN,yBAIbpB,EAAE,cAAcqB,QAChBrB,EAAE,cAAcsB,OAAOX,GACvBY,EAAKC,WAZDD,EAAKC,SAaVC,MAAK,SAACC,GACLjB,QAAQC,IAAIgB,GACZH,EAAKC,SA1KbG,OAAOC,SAAQ,SAACC,GACZN,EAAKO,MACLlC,EAAO+B,OAAOI,QAAQC,QAAQpC,MAEtBqC,mBACJnC,GAAU,EACVD,EAAcD,EAAKsC,OAAOC,aACbvC,EAAKsC,OAAOE,YACzB/B,QAAUT,EAAKyC,GAAG,GAAGF,aACrBpC,MAEAD,GAAU,EAOdwC,aAAe1C,EAAKyC,GACpBE,aAAe3C,EAAK4C,GACpBC,cAAgB7C,EAAK8C,IACrBC,eAAiB/C,EAAKgD,KAEtBN,aAAaO,UAAS,SAAUC,GACxBA,EAAYC,QAAUpB,OAAOqB,kBAAkBC,OAC/CC,MAAMJ,EAAYK,MAAMC,UAGxB3C,QAAQC,IAAI,YACZD,QAAQC,IAAIoC,EAAYO,MAAM,GAAGlB,cACjC9B,QAAUyC,EAAYO,MAAM,GAAGlB,iBAIvCQ,eAAeE,UAAS,SAAUC,GAC1BA,EAAYC,QAAUpB,OAAOqB,kBAAkBC,OAC/CxC,QAAQC,IAAIoC,EAAYK,MAAMC,UAG9B3C,QAAQC,IAAI,UACZD,QAAQC,IAAIoC,EAAYO,OACxBxD,EAAciD,EAAYO,MAAMlB,aACnBW,EAAYO,MAAMjB,YAC/BrC,YAoMZ,IAAMwB,EAAO,CACTO,GAAI,WACA9B,EAAE,eAAesD,MAAM,SAE3B9B,IAAK,WACDxB,EAAE,eAAesD,MAAM,W","sources":["webpack:///./src/newAndConfig/newAndConfig.js?"],"sourcesContent":["let yutaro = 'newAndConfig.js'\r\nlet item\r\nlet senderEmail\r\nlet senderName\r\nlet perfil_participante = 1\r\nlet potential = 1\r\nlet compose\r\n\r\nOffice.onReady((info) => {\r\n    load.on()\r\n    item = Office.context.mailbox.item;\r\n    \r\n    if(item.internetMessageId){\r\n        compose = false\r\n        senderEmail = item.sender.emailAddress\r\n        senderName = item.sender.displayName\r\n        toEmail = item.to[0].emailAddress\r\n        get_layout()\r\n    }else{\r\n        compose = true\r\n        getAllRecipients()\r\n        \r\n    }\r\n})\r\n\r\nfunction getAllRecipients() {\r\n    toRecipients = item.to;\r\n    ccRecipients = item.cc;\r\n    bccRecipients = item.bcc;\r\n    fromRecipients = item.from;\r\n    \r\n    toRecipients.getAsync(function (asyncResult) {\r\n        if (asyncResult.status == Office.AsyncResultStatus.Failed){\r\n            write(asyncResult.error.message);\r\n        }\r\n        else {\r\n            console.log('Receiver');\r\n            console.log(asyncResult.value[0].emailAddress);\r\n            toEmail = asyncResult.value[0].emailAddress\r\n        }    \r\n    })\r\n  \r\n    fromRecipients.getAsync(function (asyncResult) {\r\n        if (asyncResult.status == Office.AsyncResultStatus.Failed){\r\n            console.log(asyncResult.error.message);\r\n        }\r\n        else {\r\n            console.log('Sender');\r\n            console.log(asyncResult.value)\r\n            senderEmail = asyncResult.value.emailAddress\r\n            senderName = asyncResult.value.displayName\r\n            get_layout()\r\n        }    \r\n    })\r\n}\r\n\r\nfunction change_perfil_dropdown(item) {\r\n    console.log(item);\r\n    $('#perfil_dropdown').text($(item).text())\r\n    $('#perfil_dropdown').attr('value', $(item).attr('value'))\r\n    perfil_participante = $(item).attr('value')\r\n}\r\n\r\nfunction change_potential_dropdown(item) {\r\n    console.log(item);\r\n    $('#potential_dropdown').text($(item).text())\r\n    $('#potential_dropdown').attr('value', $(item).attr('value'))\r\n    potential = $(item).attr('value')\r\n}\r\n\r\nfunction send_intercao(){\r\n    let data = {\r\n        sender_email:  compose? toEmail : senderEmail,\r\n        to_email:  compose? senderEmail : toEmail,\r\n        id_projeto: Number($('#id_projeto').val()),\r\n        nome_projeto: $('#nome_projeto').val(),\r\n        status: Number($('#status_radio input:radio:checked').val()),\r\n        id_perfil_participante: Number(perfil_participante),\r\n        email_subject: $('#subject_input').val(),\r\n        email_body: tinyMCE.activeEditor.getContent(),\r\n        file: $('#inputGroupFile01').val(),\r\n        id_contato_visibility: $('#status_radio input:radio:checked').attr('visibility'),\r\n        id_potencial: potential\r\n    }\r\n\r\n    console.log(data);\r\n    // return\r\n    if(!data.id_projeto){\r\n        $('#id_projeto').css('border', '1px solid red')\r\n        return\r\n    }else{\r\n        $('#id_projeto').css('border', '1px solid black')\r\n    }\r\n\r\n    if(!data.nome_projeto){\r\n        $('#nome_projeto').css('border', '1px solid red')\r\n        return\r\n    }else{\r\n        $('#nome_projeto').css('border', '1px solid black')\r\n    }\r\n\r\n    load.on()\r\n    $.ajax({\r\n        url: 'https://dev.liveuniversity.com:2700/send_interacao_decline_opt_out',\r\n        method: 'post',\r\n        data: data\r\n    }).then((res) => {\r\n        load.off()\r\n        if(res[0].res == 1){\r\n            $('#sucess_modal').modal('show')   \r\n            $('.clear').val('')\r\n            tinyMCE.activeEditor.setContent('');\r\n            perfil_participante = 1\r\n            $('#perfil_dropdown').html('Aluno / Congressista')\r\n\r\n            if(data.email_body){\r\n                envia_email(data.email_subject, data.email_body, data.sender_email)\r\n            }\r\n        }else{\r\n            $('#error_modal').modal('show')   \r\n        }\r\n        \r\n    }).fail((err)=>{\r\n        load.off()\r\n        console.log(err);\r\n        $('#error_modal').modal('show')   \r\n    })\r\n}\r\n\r\nfunction save_layout(){\r\n    load.on()\r\n    let data = {\r\n        id_projeto: Number($('#id_projeto').val()),\r\n        nome_projeto: $('#nome_projeto').val(),\r\n        status: Number($('#status_radio input:radio:checked').val()),\r\n        id_perfil_participante: Number(perfil_participante),\r\n        email_subject: $('#subject_input').val(),\r\n        email_body: tinyMCE.activeEditor.getContent(),\r\n        id_contato_visibility: $('#status_radio input:radio:checked').attr('visibility'),\r\n        sender_email:  compose? senderEmail : toEmail,\r\n        id_potencial: potential\r\n    }\r\n\r\n    $.ajax({\r\n        url: 'https://dev.liveuniversity.com:2700/save_layout_panda',\r\n        method: 'post',\r\n        data: data\r\n    }).then((res) => {\r\n        $('#sucess_modal').modal('show')   \r\n        get_layout()\r\n    }).fail((err)=>{\r\n        $('#generic_error_modal').modal('show')   \r\n        load.off()\r\n    })\r\n}\r\n\r\nfunction get_layout(){\r\n    $.ajax({\r\n        url: 'https://dev.liveuniversity.com:2700/get_layout_panda',\r\n        method: 'post',\r\n        data: {senderEmail: compose? senderEmail : toEmail}\r\n    }).then((res) => {\r\n        if(res.length == 0) {\r\n            load.off()\r\n            return\r\n        }\r\n        console.log(res);\r\n        let drop_item = ''\r\n        res.forEach((item)=>{\r\n            drop_item += `\r\n                <a onclick=\"set_layout(${item.id_projeto},'${item.nome_projeto}',${item.id_perfil_participante},${item.id_contato_visibility},'${item.assunto}','${item.corpo}', ${item.id_potencial})\" value=\"\" class=\"dropdown-item\">${item.nome_layout}</a>\r\n            `\r\n        })\r\n        $('#templates').empty()\r\n        $('#templates').append(drop_item)\r\n        load.off()\r\n    }).fail((err)=>{\r\n        console.log(err); \r\n        load.off()\r\n    })\r\n}\r\n\r\nfunction set_layout(id_projeto, nome_projeto, perfil, visibility, assunto, corpo, id_potencial){\r\n    $('#id_projeto').val(id_projeto)\r\n    $('#nome_projeto').val(nome_projeto)\r\n    \r\n    $('.perfil_item').each(function(){\r\n        console.log($(this).attr('value'));\r\n        if($(this).attr('value') == perfil){           \r\n            $('#perfil_dropdown').text($(this).text())\r\n            $('#perfil_dropdown').attr('value', perfil)\r\n            perfil_participante = perfil\r\n        }\r\n    })\r\n\r\n    $('.potential_item').each(function(){\r\n        console.log($(this).attr('value'));\r\n        if($(this).attr('value') == id_potencial){           \r\n            $('#potential_dropdown').text($(this).text())\r\n            $('#potential_dropdown').attr('value', perfil)\r\n            potential = id_potencial\r\n        }\r\n    })\r\n\r\n    $('.form-check-input').each(function(i){\r\n        if($(this).attr('visibility') == visibility){\r\n            $(this).prop('checked', true)\r\n        }else{\r\n            $(this).prop('checked', false)\r\n        }\r\n    })\r\n\r\n    $('#subject_input').val(assunto)\r\n    tinyMCE.activeEditor.setContent(corpo);\r\n}\r\n\r\n\r\nfunction envia_email(subject, body, to){\r\n        body = htmlEncode(body)\r\n        var request = '<soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:m=\"http://schemas.microsoft.com/exchange/services/2006/messages\" xmlns:t=\"http://schemas.microsoft.com/exchange/services/2006/types\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">'+\r\n        '  <soap:Header><t:RequestServerVersion Version=\"Exchange2010\" /></soap:Header>'+\r\n        '  <soap:Body>'+\r\n        '    <m:CreateItem MessageDisposition=\"SendAndSaveCopy\">'+\r\n        '      <m:SavedItemFolderId><t:DistinguishedFolderId Id=\"sentitems\" /></m:SavedItemFolderId>'+\r\n        '      <m:Items>'+\r\n        '        <t:Message>'+\r\n        '          <t:Subject>' + subject +'</t:Subject>'+\r\n        '          <t:Body BodyType=\"HTML\">'+ body +'</t:Body>'+\r\n        '          <t:ToRecipients>'+\r\n        '            <t:Mailbox><t:EmailAddress>' + to + '</t:EmailAddress></t:Mailbox>'+\r\n        '          </t:ToRecipients>'+\r\n        '        </t:Message>'+\r\n        '      </m:Items>'+\r\n        '    </m:CreateItem>'+\r\n        '  </soap:Body>'+\r\n        '</soap:Envelope>';\r\n\r\n        Office.context.mailbox.makeEwsRequestAsync(request, function (asyncResult) {\r\n        if (asyncResult.status == \"failed\") {\r\n            showMessage(\"Action failed with error: \" + asyncResult.error.message);\r\n        }\r\n        else {\r\n            showMessage(\"Message sent!\");\r\n        }\r\n        });\r\n}\r\n\r\nconst load = {\r\n    on: function(){\r\n        $('#load_modal').modal('show')    \r\n    },\r\n    off: function(){\r\n        $('#load_modal').modal('hide')    \r\n    }\r\n}\r\n\r\nfunction htmlEncode(value){\r\n    // Create a in-memory element, set its inner text (which is automatically encoded)\r\n    // Then grab the encoded contents back out. The element never exists on the DOM.\r\n    return $('<textarea/>').text(value).html();\r\n  }\r\n  \r\nfunction htmlDecode(value){\r\n    return $('<textarea/>').html(value).text();\r\n}"],"names":["item","senderEmail","compose","get_layout","$","ajax","url","method","data","toEmail","then","res","length","console","log","drop_item","forEach","id_projeto","nome_projeto","id_perfil_participante","id_contato_visibility","assunto","corpo","id_potencial","nome_layout","empty","append","load","off","fail","err","Office","onReady","info","on","context","mailbox","internetMessageId","sender","emailAddress","displayName","to","toRecipients","ccRecipients","cc","bccRecipients","bcc","fromRecipients","from","getAsync","asyncResult","status","AsyncResultStatus","Failed","write","error","message","value","modal"],"sourceRoot":""}