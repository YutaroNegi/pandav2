var item,senderEmail,senderName,yutaro="newAndConfig.js",perfil_participante=1;function change_perfil_dropdown(e){$("#perfil_dropdown").html($(e).text()),perfil_participante=$(e).attr("value")}function send_intercao(){var e={sender_email:senderEmail,to_email:toEmail,id_projeto:Number($("#id_projeto").val()),nome_projeto:$("#nome_projeto").val(),status:Number($("#status_radio input:radio:checked").val()),id_perfil_participante:Number(perfil_participante),email_body:tinyMCE.activeEditor.getContent({format:"raw"}),file:$("#inputGroupFile01").val()};e.id_projeto?($("#id_projeto").css("border","1px solid black"),e.nome_projeto?($("#nome_projeto").css("border","1px solid black"),e.email_body?($("#form_div").css("border","1px solid black"),load.on(),$.ajax({url:"https://dev.liveuniversity.com:2700/send_interacao_decline_opt_out",method:"post",data:e}).then((function(o){load.off(),1==o[0].res?($("#sucess_modal").modal("show"),$(".clear").val(""),tinyMCE.activeEditor.setContent(""),perfil_participante=1,$("#perfil_dropdown").html("Aluno / Congressista"),envia_email(e.email_body,e.to_email)):$("#error_modal").modal("show")})).fail((function(e){load.off(),console.log(e),$("#error_modal").modal("show")}))):$("#form_div").css("border","1px solid red")):$("#nome_projeto").css("border","1px solid red")):$("#id_projeto").css("border","1px solid red")}function envia_email(e,o){var t='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:m="http://schemas.microsoft.com/exchange/services/2006/messages" xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">  <soap:Header><t:RequestServerVersion Version="Exchange2010" /></soap:Header>  <soap:Body>    <m:CreateItem MessageDisposition="SendAndSaveCopy">      <m:SavedItemFolderId><t:DistinguishedFolderId Id="sentitems" /></m:SavedItemFolderId>      <m:Items>        <t:Message>          <t:Subject>Hello, Outlook!</t:Subject>          <t:Body BodyType="HTML">'+(e=htmlEncode(e))+"</t:Body>          <t:ToRecipients>            <t:Mailbox><t:EmailAddress>"+o+"</t:EmailAddress></t:Mailbox>          </t:ToRecipients>        </t:Message>      </m:Items>    </m:CreateItem>  </soap:Body></soap:Envelope>";Office.context.mailbox.makeEwsRequestAsync(t,(function(e){"failed"==e.status?showMessage("Action failed with error: "+e.error.message):showMessage("Message sent!")}))}Office.onReady((function(e){item=Office.context.mailbox.item,senderEmail=item.sender.emailAddress,senderName=item.sender.displayName,toEmail=item.to[0].emailAddress}));var load={on:function(){$("#load_modal").modal("show")},off:function(){$("#load_modal").modal("hide")}};function htmlEncode(e){return $("<textarea/>").text(e).html()}function htmlDecode(e){return $("<textarea/>").html(e).text()}