var item,client_email,operator_email,compose,user_email,yutaro="script_config.js",id_layout_arr=[];function getAllRecipients(){toRecipients=item.to,ccRecipients=item.cc,bccRecipients=item.bcc,fromRecipients=item.from,toRecipients.getAsync((function(t){t.status==Office.AsyncResultStatus.Failed?write(t.error.message):(console.log("Receiver"),console.log(t.value[0].emailAddress),client_email=t.value[0].emailAddress)})),fromRecipients.getAsync((function(t){t.status==Office.AsyncResultStatus.Failed?console.log(t.error.message):(console.log("Sender"),console.log(t.value),operator_email=t.value.emailAddress,get_layout_decline_proposal())}))}Office.onReady((function(t){load.on(),item=Office.context.mailbox.item,user_email=Office.context.mailbox.userProfile.emailAddress,item.internetMessageId?(compose=!1,client_email=item.sender.emailAddress,operator_email=item.to[0].emailAddress,get_layout_decline_proposal()):(compose=!0,getAllRecipients())}));var load={on:function(){$("#load_modal").modal("show")},off:function(){$("#load_modal").modal("hide")}};function get_layout_decline_proposal(){console.log(user_email,"email"),$.ajax({url:"https://dev.liveuniversity.com:2742/get_layout_decline_proposal",method:"post",data:{operator_email:user_email}}).then((function(t){console.log(t),declines=t.declines,proposals=t.proposals;var o="";declines.forEach((function(t){o+='\n                <tr class="interacao_rows" id_portal="'.concat(t.id_portal,'">\n                    <th scope="row">\n                        <div class="form-check">\n                            <input onclick="checkbox(this)" class="form-check-input hover-pointer" type="checkbox" value="').concat(t.id_panda_layout,'" id_projeto="').concat(t.id_projeto,'" id_potencial="').concat(t.id_potencial,'" id_visibility="').concat(t.id_contato_visibility,'" id_perfil_participante="').concat(t.id_perfil_participante,'" nome_projeto="').concat(t.nome_projeto,'" assunto="').concat(t.assunto,'" corpo="').concat(t.corpo,'" favorite="').concat(t.favorito,'">\n                        </div>\n                    </th>\n                    <td>').concat(t.id_projeto,"</td>\n                    <td>").concat(t.nome_projeto,"</td>\n                </tr>\n            ")})),$("#decline_body").empty(),$("#decline_body").append(o);var e="";proposals.forEach((function(t){e+='\n                <tr class="interacao_rows" id_portal="'.concat(t.id_portal,'">\n                    <th scope="row">\n                        <div class="form-check">\n                            <input onclick="checkbox(this)" class="form-check-input hover-pointer" type="checkbox" value="').concat(t.id_panda_layout,'"  id_projeto="').concat(t.id_projeto,'" id_potencial="').concat(t.id_potencial,'" id_visibility="').concat(t.id_contato_visibility,'" id_perfil_participante="').concat(t.id_perfil_participante,'" nome_projeto="').concat(t.nome_projeto,'" assunto="').concat(t.assunto,'" corpo="').concat(t.corpo,'" favorite="').concat(t.favorito,'">\n                        </div>\n                    </th>\n                    <td>').concat(t.id_projeto,"</td>\n                    <td>").concat(t.nome_projeto,"</td>\n                </tr>\n            ")})),$("#proposal_body").empty(),$("#proposal_body").append(e),load.off()})).fail((function(t){console.log(t),load.off()}))}function change_school_dropdown(t){var o=$(t).attr("value");$("#school_btn").text($(t).text()),$("#school_btn").attr("value",$(t).attr("value")),0!=o?$(".interacao_rows").each((function(){$(this).attr("id_portal")==o?$(this).removeClass("d-none"):$(this).addClass("d-none")})):$(".interacao_rows").each((function(){$(this).removeClass("d-none")}))}function change_potential_dropdown(t){$(t).attr("value"),$("#potential_drop").text($(t).text()),$("#potential_drop").attr("value",$(t).attr("value"))}function change_visibility_dropdown(t){$(t).attr("value"),$("#visibility_drop").text($(t).text()),$("#visibility_drop").attr("value",$(t).attr("value"))}function change_profile_dropdown(t){$(t).attr("value"),$("#profile_drop").text($(t).text()),$("#profile_drop").attr("value",$(t).attr("value"))}function checkbox(t){$(t).hasClass("checked")?($(t).removeClass("checked"),id_layout_arr=id_layout_arr.filter((function(o){return o!=$(t).attr("value")})),console.log(id_layout_arr)):($(t).addClass("checked"),id_layout_arr.push($(t).attr("value")),console.log(id_layout_arr)),1==$(".checked").length?$("#edit_btn").removeClass("disabled"):$("#edit_btn").addClass("disabled"),$(".checked").length>0?$("#delete_btn").removeClass("disabled"):$("#delete_btn").addClass("disabled"),console.log($(".checked").length)}function delete_layout_panda(){$("#delete_btn").hasClass("disabled")||(load.on(),$.ajax({url:"https://dev.liveuniversity.com:2742/delete_layout_panda",method:"post",data:{id_layout_arr}}).then((function(t){console.log(t),$(".checked").each((function(){$(this).parent().parent().parent().remove()})),load.off(),$("#sucess_modal").modal("show")})).fail((function(t){console.log(t),load.off()})))}function open_edit_modal(){if(console.log("edit"),!$("#edit_btn").hasClass("disabled")){var t=$(".checked")[0],o=$(t).attr("id_projeto"),e=$(t).attr("id_potencial"),a=$(t).attr("id_visibility"),i=$(t).attr("value"),n=$(t).attr("id_perfil_participante"),c=$(t).attr("nome_projeto"),l=$(t).attr("assunto"),r=$(t).attr("corpo");1==$(t).attr("favorite")?$("#favorite_check").prop("checked",!0):$("#favorite_check").prop("checked",!1),$("#id_projeto_edit_input").val(o),$("#nome_projeto_edit_input").val(c),$("#subject_edit_input").val(l),tinyMCE.activeEditor.setContent(r),$(".potential_item").each((function(){$(this).attr("value")==e&&$(this).click()})),$(".visibility_item").each((function(){$(this).attr("value")==a&&$(this).click()})),$(".profile_item").each((function(){$(this).attr("value")==n&&$(this).click()})),$("#save_edit_btn").attr("onclick","save_edit_layout(".concat(i,")")),$("#edit_modal").modal("show")}}function save_edit_layout(t){var o={id_projeto:$("#id_projeto_edit_input").val(),nome_projeto:$("#nome_projeto_edit_input").val(),id_perfil_participante:$("#profile_drop").attr("value"),id_contato_visibility:$("#visibility_drop").attr("value"),assunto:$("#subject_edit_input").val(),corpo:tinyMCE.activeEditor.getContent(),id_potencial:$("#potential_drop").attr("value"),id_layout:t,favorite:$("favorite_check").is("checked")?1:0};console.log(o),o.nome_projeto?($("#nome_projeto_edit_input").css("border","1px solid black"),$("#edit_modal").modal("hide"),load.on(),$.ajax({url:"https://dev.liveuniversity.com:2742/save_edit_layout",method:"post",data:o}).then((function(t){console.log(t),load.off(),$("#sucess_modal").modal("show"),get_layout_decline_proposal()})).fail((function(t){console.log(t),load.off()}))):$("#nome_projeto_edit_input").css("border","1px solid red")}